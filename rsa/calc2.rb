
e = 65537

p = 67154383187368105953100815609503747841658624328272849099077363896857256065079
q = 73754156800644948852331458243535534935931587698205162300114582626172448344193
n = p * q
c = 458433748349201262280777313768259771974417646788674819145270059285871652914881358304680368169421824978387702712376244187234896682909083498675530414507690

nn = (q - 1) * (p - 1)
puts "nn=" + nn.to_s
puts "check (is 1?): gcd(nn,e) = " + nn.gcd(e).to_s

for x in 0..e do
    if ((x * nn + 1) % e) == 0 then
        puts "hit"
        d = (x * nn + 1) / e
        break
    end
end

puts "d=" + d.to_s
puts "check (is 1?): (d*e)mod(nn) = " + (d * e % nn).to_s

# c = m**e mod n
# m = c**d mod n

arr = []
ct = c
arr.push(ct)
i = 0
t = 1
while t * 2 <= d do
   ct = (ct ** 2) % n
   arr.push(ct)
   i += 1
   t *= 2
end
#puts "  " + t.to_s
#puts arr
m = 1
while i != -1 do
    if t <= d then
        d -= t
        puts d
        m = (m * arr[i]) % n
    end
    i -= 1
    t /= 2
end
# m=539522014458593754437455308634533548864234592054632819154077405066418321155789028975698372744946414528895965329127960449169413669312038109503836251276511421379953834556314332595049563590139950816280467024044979665185282968943740203883019446079168305071483638283152069928459679074250978991108950732337351278311376630672120282981443427854372655203142446302330949162723124201682740678050087623278691656224582873617219539947118508150464700460150425383889231280319667673486778986912491994052344472732330545728958590186776266763450151725718798763813472223088549359451970172733029383487637042158022741873482100990501182501831000113202791645823085657947288692823248318848612209287336186577576467880998992609805453393604844233943194574375464951861215971758694813792045933173286329917834066677200913085312741854551593679170401826549637794251818668944430491058869212812749189752121930461172307329007612217634133148135925053187251938291847645397868355775786084702505965821924929255875885597444128648534762536602427492317729157304800118870779927028789865832783474537637195857535453356812780548802370000593790883408454514682832957850388749823249390039911896802646049328677162759047179975656136619463829508838633353287812103473352704054289982867874
puts "m=" + m.to_s

=begin arr = [] ct = c
arr.push(ct)
i = 0
t = 1
while t * 2 <= d do
   ct = (ct ** 2) % n
   arr.push(ct)
   i += 1
   t *= 2
end
#puts "  " + t.to_s
#puts arr
m = 1
while i != -1 do
    if t <= d then
        d -= t
        puts d
        m = (m * arr[i]) % n
    end
    t /= 2
    i -= 1
end
###
=end
